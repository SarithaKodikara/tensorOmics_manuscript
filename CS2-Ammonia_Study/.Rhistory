library(zCompositions)
# Function to remove low abundance features
low.count.removal <- function(
data, # OTU count df of size n (sample) x p (OTU)
percent = 0.01 # cutoff chosen
) {
keep.otu <- which(colSums(data) * 100 / sum(colSums(data)) > percent)
data.filter <- data[, keep.otu]
return(list(data.filter = data.filter, keep.otu = keep.otu))
}
#### Reading Data ####
# A supernatant is a liquid or medium which remains above a pellet after
# centrifugation and is composed of lighter or smaller materials.
# More accurate to predict the pellet based on the supernatant rather
# than the other way around
# https://pmc.ncbi.nlm.nih.gov/articles/PMC4313957/
# https://pubmed.ncbi.nlm.nih.gov/28667629/
LCMS_supernatant <- read.csv('Data_org/supernant/LCMS_xcms.csv', row.names = 1)
metaData_supernatant <- read.csv('Data_org/supernant/metadata.csv', row.names = 1)
LCMS_pellet <- read.csv('Data_org/pellet/LCMS_xcms.csv', row.names = 1)
metaData_pellet <- read.csv('Data_org/pellet/metadata.csv', row.names = 1)
# Add row IDs to metadata
metaData_supernatant$id <- rownames(metaData_supernatant)
metaData_pellet$id <- rownames(metaData_pellet)
# Get metadata ids in both files using inner join on id
ids <- inner_join(metaData_supernatant, metaData_pellet, by = join_by("id"))%>%
select(id)%>%unlist()
# metaData_filtered to only those ids
metaData <- metaData_supernatant[ids, ]
# Filter metadata for experimental groups
meta_filtered <- filter(metaData,
group %in% c("Control", "Carbonate",
"Chloride", "Phosphate"))
meta_filtered$number_of_days<-as.numeric(meta_filtered$number_of_days))
meta_filtered$number_of_days<-as.numeric(meta_filtered$number_of_days)
View(meta_filtered)
# Filter metadata for blanks
meta_filtered_bl <- filter(metaData,
!(group %in% c("Control", "Carbonate",
"Chloride", "Phosphate")))
# Calculate median values from blanks
LCMS_supernatant_bl <- apply(LCMS_supernatant[meta_filtered_bl$id, ], 2, median)
LCMS_pellet_bl <- apply(LCMS_pellet[meta_filtered_bl$id, ], 2, median)
# Filter LCMS data for experimental samples
LCMS_supernatant_fil_1 <- LCMS_supernatant[meta_filtered$id, ]
LCMS_pellet_fil_1 <- LCMS_pellet[meta_filtered$id, ]
# Impute zeros with blank medians
LCMS_supernatant_fil_imp <- LCMS_supernatant_fil_1 %>%
mutate(across(
names(LCMS_supernatant_bl),
~ ifelse(. == 0, LCMS_supernatant_bl[cur_column()], .)
))
LCMS_pellet_fil_imp <- LCMS_pellet_fil_1 %>%
mutate(across(
names(LCMS_pellet_bl),
~ ifelse(. == 0, LCMS_pellet_bl[cur_column()], .)
))
# Remove low abundance features
LCMS_supernatant_fil2_imp <- low.count.removal(LCMS_supernatant_fil_imp, percent = 0.01)$data.filter
LCMS_pellet_fil2_imp <- low.count.removal(LCMS_pellet_fil_imp, percent = 0.01)$data.filter
# Log transformation
LCMS_pellet_log <- log(LCMS_pellet_fil2_imp + 1)
LCMS_supernatant_log <- log(LCMS_supernatant_fil2_imp + 1)
save(
LCMS_supernatant_log, LCMS_pellet_log,
meta_filtered,
file = "Data_filtered/anaerobicStudy.RData")
knitr::opts_chunk$set(echo = TRUE)
cat('
<div style="background-color: #f0f8ff; border-left: 5px solid #4682b4; padding: 15px; margin: 20px 0; border-radius: 5px;">
<strong style="color: #2c5282; font-size: 16px;">Understanding the Visualizations</strong>
<p>This vignette uses three complementary visualization types:</p>
<strong style="color: #2c5282;">Sample Plots (Score Plots)</strong>
<p>Sample plots show how replicates are positioned in the reduced dimensional space:</p>
<ul>
<li><strong>Each point</strong> represents a replicate\'s complete temporal trajectory across both metabolomic layers</li>
<li><strong>Distance between points</strong> reflects similarity in metabolic profiles</li>
<li><strong>Axes (Components)</strong>: Each axis represents a latent component capturing covariance between supernatant and pellet</li>
<li><strong>Color coding</strong>: Points are colored by treatment group (Control = orange, Carbonate = green, Chloride = blue, Phosphate = pink)</li>
</ul>
<strong style="color: #2c5282;">Loading Plots (Variable Contribution Plots)</strong>
<p>Loading plots reveal which metabolites drive the separation between treatment groups:</p>
<ul>
<li><strong>Left panel (Bar plot)</strong>: Displays absolute loading values ordered by magnitude. Positive loadings (pink) associate with groups on the positive side of the component, while negative loadings (blue) associate with the negative side.</li>
<li><strong>Right panel (Line plot)</strong>: Shows mean temporal profiles of the corresponding metabolites for each group, revealing how metabolite abundance changes over time.</li>
</ul>
<strong style="color: #2c5282;">Correlation Density Heatmaps</strong>
<p>These heatmaps visualize the temporal stability of metabolic coordination between compartments:</p>
<ul>
<li><strong>Each column</strong> represents a metabolite pair (supernatant/pellet)</li>
<li><strong>Y-axis</strong>: Correlation values ranging from -1 to 1</li>
<li><strong>Color intensity</strong>: Darker regions indicate higher density of correlations across time points</li>
<li><strong>Red column labels</strong>: Predominantly positive correlations (coordinated regulation)</li>
<li><strong>Blue column labels</strong>: Predominantly negative correlations (antagonistic regulation)</li>
</ul>
<p>Concentrated dark bands indicate temporally stable relationships, while dispersed patterns suggest time-varying coordination.</p>
</div>
')
library(mixOmics)
library(mixOmicsTemporal)
library(dplyr)
library(tidyr)
library(plotly)
library(gridExtra)
library(patchwork)
library(scales)
library(stringr)
library(purrr)
library(ComplexHeatmap)
library(RColorBrewer)
source("../helper/utility.R")
set.seed(1234)
# Define color scheme for groups
custom_colors <- c("Control" = "blue",
"Carbonate" = "orange",
"Chloride" = "green",
"Phosphate"= "hotpink")
knitr::opts_chunk$set(echo = TRUE)
cat('
<div style="background-color: #f0f8ff; border-left: 5px solid #4682b4; padding: 15px; margin: 20px 0; border-radius: 5px;">
<strong style="color: #2c5282; font-size: 16px;">Understanding the Visualizations</strong>
<p>This vignette uses three complementary visualization types:</p>
<strong style="color: #2c5282;">Sample Plots (Score Plots)</strong>
<p>Sample plots show how replicates are positioned in the reduced dimensional space:</p>
<ul>
<li><strong>Each point</strong> represents a replicate\'s complete temporal trajectory across both metabolomic layers</li>
<li><strong>Distance between points</strong> reflects similarity in metabolic profiles</li>
<li><strong>Axes (Components)</strong>: Each axis represents a latent component capturing covariance between supernatant and pellet</li>
<li><strong>Color coding</strong>: Points are colored by treatment group (Control = orange, Carbonate = green, Chloride = blue, Phosphate = pink)</li>
</ul>
<strong style="color: #2c5282;">Loading Plots (Variable Contribution Plots)</strong>
<p>Loading plots reveal which metabolites drive the separation between treatment groups:</p>
<ul>
<li><strong>Left panel (Bar plot)</strong>: Displays absolute loading values ordered by magnitude. Positive loadings (pink) associate with groups on the positive side of the component, while negative loadings (blue) associate with the negative side.</li>
<li><strong>Right panel (Line plot)</strong>: Shows mean temporal profiles of the corresponding metabolites for each group, revealing how metabolite abundance changes over time.</li>
</ul>
<strong style="color: #2c5282;">Correlation Density Heatmaps</strong>
<p>These heatmaps visualize the temporal stability of metabolic coordination between compartments:</p>
<ul>
<li><strong>Each column</strong> represents a metabolite pair (supernatant/pellet)</li>
<li><strong>Y-axis</strong>: Correlation values ranging from -1 to 1</li>
<li><strong>Color intensity</strong>: Darker regions indicate higher density of correlations across time points</li>
<li><strong>Red column labels</strong>: Predominantly positive correlations (coordinated regulation)</li>
<li><strong>Blue column labels</strong>: Predominantly negative correlations (antagonistic regulation)</li>
</ul>
<p>Concentrated dark bands indicate temporally stable relationships, while dispersed patterns suggest time-varying coordination.</p>
</div>
')
library(mixOmics)
library(mixOmicsTemporal)
library(dplyr)
library(tidyr)
library(plotly)
library(gridExtra)
library(patchwork)
library(scales)
library(stringr)
library(purrr)
library(ComplexHeatmap)
library(RColorBrewer)
source("../helper/utility.R")
set.seed(1234)
# Define color scheme for groups
custom_colors <- c("Control" = "blue",
"Carbonate" = "orange",
"Chloride" = "green",
"Phosphate"= "hotpink")
# Read log-transformed metabolomic data
load("Data_filtered/anaerobicStudy.RData")
# Read and prepare metadata
meta <- meta_filtered %>%
mutate(Group_replicate = paste0(group, "_", replicate))
# Merge metadata with metabolomic data
merged_supernant_df <- merge(meta, LCMS_supernatant_log,
by = "row.names", all = TRUE)
merged_pellet_df <- merge(meta, LCMS_pellet_log,
by = "row.names", all = TRUE)
# Display data dimensions
cat("Dataset dimensions:\n")
cat("- Reactors:", length(unique(merged_supernant_df$Group_replicate)), "\n")
cat("- Supernatant metabolites:", ncol(LCMS_supernatant_log), "\n")
cat("- Pellet metabolites:", ncol(LCMS_pellet_log), "\n")
cat("- Time points (days 6-55):", length(unique(merged_supernant_df$number_of_days)) - 1, "\n")
# Calculate dimensions
n <- length(unique(merged_supernant_df$Group_replicate))  # Number of replicates
p <- ncol(LCMS_supernatant_log)                # Supernatant metabolites
q <- ncol(LCMS_pellet_log)                   # Pellet metabolites
t <- length(unique(merged_supernant_df$number_of_days))  # Time points
# Initialize arrays
pellet_Y_array <- array(0, dim = c(n, q, t))
supernant_X_array <- array(0, dim = c(n, p, t))
group_array <- array(NA, dim = c(n, 1, t))
# Fill arrays for each time point
for (i in 1:t) {
day <- unique(merged_supernant_df$number_of_days)[i]
indiv_index <- which(merged_supernant_df$number_of_days == day)
pellet_Y_array[,,i] <- as.matrix(merged_pellet_df[indiv_index, -c(1:6)])
supernant_X_array[,,i] <- as.matrix(merged_supernant_df[indiv_index, -c(1:6)])
group_array[,,i] <- matrix(merged_supernant_df$group[indiv_index], ncol = 1)
}
# Focus on days 6-55 (exclude day 0 due to high variability)
supernant_X_array <- supernant_X_array[,,2:9]
pellet_Y_array <- pellet_Y_array[,,2:9]
cat("Tensor structure:\n")
cat("- Supernatant:", paste(dim(supernant_X_array), collapse = " × "),
"(replicates × metabolites × time)\n")
cat("- Pellet:", paste(dim(pellet_Y_array), collapse = " × "),
"(replicates × metabolites × time)\n")
# Fit tPLS model with 4 components
tpls_res <- tpls(
x = supernant_X_array,
y = pellet_Y_array,
ncomp = 4,
mode = "canonical"
)
# Create results dataframe
res_df <- data.frame(
Group = group_array[,,1],
PC1_x = tpls_res$x_projected[,1],
PC2_x = tpls_res$x_projected[,2],
PC3_x = tpls_res$x_projected[,3],
PC4_x = tpls_res$x_projected[,4],
PC1_y = tpls_res$y_projected[,1],
PC2_y = tpls_res$y_projected[,2],
PC3_y = tpls_res$y_projected[,3],
PC4_y = tpls_res$y_projected[,4]
)
rownames(res_df) <- unique(merged_supernant_df$Group_replicate)
head(res_df)
ggplot(res_df, aes(x = PC1_x, y = PC2_x, color = Group)) +
geom_point(size = 3) +
ggtitle("Supernatant (Component 1 & 2)") +
theme_bw() +
scale_color_manual(values = custom_colors) +
xlab("Component 1") +
ylab("Component 2") +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
legend.position = "right"
)
loadingPlot<-function(loadings, top=8 ,merged_df,comp= 1,
negGroup=NULL, posGroup=NULL){
loadings_cmp <- loadings[, comp]
names(loadings_cmp)<-colnames(merged_df[, -c(1:6) ])
# Calculate the absolute values and sort the indices based on absolute values
sorted_indices<- order(abs(loadings_cmp), decreasing = TRUE)
# Sort the categories and values based on the sorted indices
sorted_comp <- colnames(merged_df[, -c(1:6) ])[sorted_indices[1:top]]
sorted_loadings_comp <- loadings_cmp[sorted_comp[1:top]]
max_loading<- max(abs(sorted_loadings_comp))
tmp_df <- data.frame(
metabolite = sorted_comp,
loading = sorted_loadings_comp
)
# Define spacing factor for gaps (increase this to increase gap)
gap_spacing <- 1.1  # 1.0 = original, 1.5 = 50% more space, 2.0 = double space
tmp_df$metabolite<- factor(tmp_df$metabolite, levels = sorted_comp)
tmp_df <- tmp_df %>%
mutate(sign = ifelse(loading >= 0, "positive", "negative")) %>%
mutate(ypos = (as.numeric(metabolite)-1) * gap_spacing + 1)
merged_df_sel <-merged_df[,c("group", "number_of_days", "replicate", sorted_comp)]%>%
filter(number_of_days !=0)
merged_df_mean <- merged_df_sel %>%
summarise(
.by = c(group, number_of_days),                 # grouping done here
across(
all_of(sorted_comp),
~ mean(.x, na.rm = TRUE),
.names = "{.col}"                      # clearer column names
)
)
long_dat <-pivot_longer(
merged_df_mean,
cols = -c(group, number_of_days),
names_to = "metabolite",
values_to = "mean_value"
)
long_dat$metabolite <- factor(long_dat$metabolite, levels = sorted_comp)
# Assign y-position for each category
long_dat <- long_dat %>% mutate(ypos = (as.numeric(metabolite)-1) * gap_spacing + 1)
y_breaks <- (0:(top-1)) * gap_spacing + 1
long_dat <- long_dat %>%
left_join(tmp_df%>%select(metabolite, loading), by = "metabolite")%>%
mutate(sign_type = ifelse(loading >= 0, "positive", "negative"),
alpha_label = ifelse((sign_type == "positive" & group %in% posGroup), "High alpha",
ifelse((sign_type == "negative" & group %in% negGroup), "High alpha", "Low alpha")))%>%
group_by(metabolite) %>%
mutate(value_scaled = rescale(mean_value, to = c(unique(ypos) - 0.4, unique(ypos) + 0.4))) %>%
mutate(time = rescale(number_of_days, to = c(0, max_loading)))%>%
ungroup()
# Plot
custom_colors <- c("Control" = "blue",
"Carbonate" = "orange",
"Chloride" = "green",
"Phosphate"= "hotpink")
P<-ggplot(long_dat, aes(x = time)) +
geom_rect(data = tmp_df,
aes(xmin = pmin(0, -abs(loading)/3), xmax = pmax(0, -abs(loading)),
ymin = ypos - 0.4, ymax = ypos + 0.4, fill = sign),
alpha = 0.8, inherit.aes = FALSE) +
scale_y_continuous(breaks = y_breaks, labels = sorted_comp) +
scale_fill_manual(
values = c(positive = "#e39894" , negative = "#8fafd9"),
name   = "Loading"
) +
guides(fill = guide_legend(reverse = TRUE))+
ggnewscale::new_scale_fill() +
geom_ribbon(aes(ymin = ypos - 0.4, ymax = ypos + 0.4,
group = interaction(group, metabolite),
fill = sign_type),
alpha = 0.02, show.legend = FALSE) +
scale_fill_manual(
values = c(positive ="red", negative = "blue"),
name = "Loading"
)+
geom_line(aes(y = value_scaled,
group = interaction(group, metabolite),
colour = group,
linetype = alpha_label,
alpha = alpha_label),
size   = 1)+
scale_color_manual(values = custom_colors, name = "Group") +
scale_alpha_manual(values = c("High alpha" = 1, "Low alpha" = 0.35), guide = "none") +
scale_linetype_manual(values = c("High alpha" = 1, "Low alpha" = 1), guide = "none") +
scale_x_continuous(
breaks = waiver(),
labels = function(b) ifelse(b == 0, "6", "")
) +
labs(y = "", title = "") +
theme_minimal() +
theme(
panel.grid.major = element_blank(),
axis.line.x = element_line(),
legend.position = "none",
plot.margin = margin(20, 10, 60, 10)
) +
#annotate("text", x = max_loading, y = min(tmp_df$ypos) - 0.6, label = "Time", size = 4.5) +
#annotate("text", x = (-max_loading)/4-0.001, y = min(tmp_df$ypos) - 0.6, label = "|Loading|", size = 4.5) +
geom_vline(xintercept = 0, colour = "black", linetype = "dashed") +
labs(x = NULL)
return(P)
}
loadingPlot(loadings = tpls_res$x_loadings,  top=8, merged_supernant_df,
comp = 1, negGroup = c("Control", "Chloride"),
posGroup = c("Carbonate", "Phosphate"))
knitr::opts_chunk$set(echo = TRUE)
cat('
<div style="background-color: #f0f8ff; border-left: 5px solid #4682b4; padding: 15px; margin: 20px 0; border-radius: 5px;">
<strong style="color: #2c5282; font-size: 16px;">Understanding the Visualizations</strong>
<p>This vignette uses three complementary visualization types:</p>
<strong style="color: #2c5282;">Sample Plots (Score Plots)</strong>
<p>Sample plots show how replicates are positioned in the reduced dimensional space:</p>
<ul>
<li><strong>Each point</strong> represents a replicate\'s complete temporal trajectory across both metabolomic layers</li>
<li><strong>Distance between points</strong> reflects similarity in metabolic profiles</li>
<li><strong>Axes (Components)</strong>: Each axis represents a latent component capturing covariance between supernatant and pellet</li>
<li><strong>Color coding</strong>: Points are colored by treatment group (Control = orange, Carbonate = green, Chloride = blue, Phosphate = pink)</li>
</ul>
<strong style="color: #2c5282;">Loading Plots (Variable Contribution Plots)</strong>
<p>Loading plots reveal which metabolites drive the separation between treatment groups:</p>
<ul>
<li><strong>Left panel (Bar plot)</strong>: Displays absolute loading values ordered by magnitude. Positive loadings (pink) associate with groups on the positive side of the component, while negative loadings (blue) associate with the negative side.</li>
<li><strong>Right panel (Line plot)</strong>: Shows mean temporal profiles of the corresponding metabolites for each group, revealing how metabolite abundance changes over time.</li>
</ul>
<strong style="color: #2c5282;">Correlation Density Heatmaps</strong>
<p>These heatmaps visualize the temporal stability of metabolic coordination between compartments:</p>
<ul>
<li><strong>Each column</strong> represents a metabolite pair (supernatant/pellet)</li>
<li><strong>Y-axis</strong>: Correlation values ranging from -1 to 1</li>
<li><strong>Color intensity</strong>: Darker regions indicate higher density of correlations across time points</li>
<li><strong>Red column labels</strong>: Predominantly positive correlations (coordinated regulation)</li>
<li><strong>Blue column labels</strong>: Predominantly negative correlations (antagonistic regulation)</li>
</ul>
<p>Concentrated dark bands indicate temporally stable relationships, while dispersed patterns suggest time-varying coordination.</p>
</div>
')
library(mixOmics)
library(mixOmicsTemporal)
library(dplyr)
library(tidyr)
library(plotly)
library(gridExtra)
library(patchwork)
library(scales)
library(stringr)
library(purrr)
library(ComplexHeatmap)
library(RColorBrewer)
source("../helper/utility.R")
set.seed(1234)
# Define color scheme for groups
custom_colors <- c("Control" = "blue",
"Carbonate" = "orange",
"Chloride" = "green",
"Phosphate"= "hotpink")
# Read log-transformed metabolomic data
load("Data_filtered/anaerobicStudy.RData")
# Read and prepare metadata
meta <- meta_filtered %>%
mutate(Group_replicate = paste0(group, "_", replicate))
# Merge metadata with metabolomic data
merged_supernant_df <- merge(meta, LCMS_supernatant_log,
by = "row.names", all = TRUE)
merged_pellet_df <- merge(meta, LCMS_pellet_log,
by = "row.names", all = TRUE)
# Display data dimensions
cat("Dataset dimensions:\n")
cat("- Reactors:", length(unique(merged_supernant_df$Group_replicate)), "\n")
cat("- Supernatant metabolites:", ncol(LCMS_supernatant_log), "\n")
cat("- Pellet metabolites:", ncol(LCMS_pellet_log), "\n")
cat("- Time points (days 6-55):", length(unique(merged_supernant_df$number_of_days)) - 1, "\n")
# Calculate dimensions
n <- length(unique(merged_supernant_df$Group_replicate))  # Number of replicates
p <- ncol(LCMS_supernatant_log)                # Supernatant metabolites
q <- ncol(LCMS_pellet_log)                   # Pellet metabolites
t <- length(unique(merged_supernant_df$number_of_days))  # Time points
# Initialize arrays
pellet_Y_array <- array(0, dim = c(n, q, t))
supernant_X_array <- array(0, dim = c(n, p, t))
group_array <- array(NA, dim = c(n, 1, t))
# Fill arrays for each time point
for (i in 1:t) {
day <- unique(merged_supernant_df$number_of_days)[i]
indiv_index <- which(merged_supernant_df$number_of_days == day)
pellet_Y_array[,,i] <- as.matrix(merged_pellet_df[indiv_index, -c(1:6)])
supernant_X_array[,,i] <- as.matrix(merged_supernant_df[indiv_index, -c(1:6)])
group_array[,,i] <- matrix(merged_supernant_df$group[indiv_index], ncol = 1)
}
# Focus on days 6-55 (exclude day 0 due to high variability)
supernant_X_array <- supernant_X_array[,,2:9]
pellet_Y_array <- pellet_Y_array[,,2:9]
cat("Tensor structure:\n")
cat("- Supernatant:", paste(dim(supernant_X_array), collapse = " × "),
"(replicates × metabolites × time)\n")
cat("- Pellet:", paste(dim(pellet_Y_array), collapse = " × "),
"(replicates × metabolites × time)\n")
# Fit tPLS model with 4 components
tpls_res <- tpls(
x = supernant_X_array,
y = pellet_Y_array,
ncomp = 4,
mode = "canonical"
)
# Create results dataframe
res_df <- data.frame(
Group = group_array[,,1],
PC1_x = tpls_res$x_projected[,1],
PC2_x = tpls_res$x_projected[,2],
PC3_x = tpls_res$x_projected[,3],
PC4_x = tpls_res$x_projected[,4],
PC1_y = tpls_res$y_projected[,1],
PC2_y = tpls_res$y_projected[,2],
PC3_y = tpls_res$y_projected[,3],
PC4_y = tpls_res$y_projected[,4]
)
rownames(res_df) <- unique(merged_supernant_df$Group_replicate)
head(res_df)
ggplot(res_df, aes(x = PC1_x, y = PC2_x, color = Group)) +
geom_point(size = 3) +
ggtitle("Supernatant (Component 1 & 2)") +
theme_bw() +
scale_color_manual(values = custom_colors) +
xlab("Component 1") +
ylab("Component 2") +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
legend.position = "right"
)
loadingPlot(
loadings = result$x_loadings,
merged_df = metabolite_df,
comp = 1,
top = 8,
negGroup = c("Chloride"),
posGroup = c("Control", "Carbonate"),
group_col = "group",
time_col = "number_of_days",
id_col = "replicate",
feature_start_col = 7,
feature_label = "Metabolite",
time_label = "6",
use_letters = FALSE,  # Show full metabolite names
group_colors = c(
"Control" = "blue",
"Carbonate" = "orange",
"Chloride" = "green",
"Phosphate" = "hotpink"
)
)
loadingPlot(
loadings = tpls_res$x_loadings,
merged_df = merged_supernant_df,
comp = 1,
top = 8,
negGroup = c("Control", "Chloride"),
posGroup = c("Carbonate", "Phosphate"),
group_col = "group",
time_col = "number_of_days",
id_col = "replicate",
feature_start_col = 7,
feature_label = "Metabolite",
time_label = "6",
use_letters = FALSE,  # Show full metabolite names
group_colors = c(
"Control" = "blue",
"Carbonate" = "orange",
"Chloride" = "green",
"Phosphate" = "hotpink"
)
)
